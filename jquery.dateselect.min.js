(function(a){a.fn.dateselect=function(b){b=a.extend({},a.fn.dateselect.defaults,b);var f=[31,28,31,30,31,30,31,31,30,31,30,31];function c(g){return((g%4===0)&&((g%100!==0)||(g%400===0)))?true:false}function e(g){g=parseInt(g);return(g<10)?"0"+g.toString():g}function d(i){var h;var g=function(j,k){j=parseInt(j,10).toString(16);if(k<j.length){return j.slice(j.length-k)}if(k>j.length){return Array(1+(k-j.length)).join("0")+j}return j};if(!this.php_js){this.php_js={}}if(!this.php_js.uniqidSeed){this.php_js.uniqidSeed=Math.floor(Math.random()*123456789)}this.php_js.uniqidSeed++;h=i;h+=g(parseInt(new Date().getTime()/1000,10),8);h+=g(this.php_js.uniqidSeed,5);return h}this.each(function(n,p){a(p).addClass("dateselect-input");if(p.id===""){p.id=d("ds")}if(typeof p.tabindex==="undefined"){p.tabindex=0}if(a("#dateselect-"+p.id).length>0){return}var o;var l=(p.value===""||p.value==="0000-00-00"||(null===(o=p.value.match(/[0-9]{4}-[0-9]{2}-[0-9]{2}/))))?false:true;if(l){var g=o[0].split("-"),r=g[0],j=g[1],q=g[2]}a(p).before('<div id="dateselect-'+p.id+'" class="dateselect '+b.cssClass+'" />').appendTo("#dateselect-"+p.id).hide();a.each(b.order,function(s,m){a("div#dateselect-"+p.id).append('<select id="'+p.id+"-"+m+'" class="dateselect-selector dateselect-'+m+" "+b.cssClassSelector+'" style="width:auto!important; min-width:0 !important;" tabindex="'+p.tabindex+'">'+(!l?'<option value="">'+b.selectOne[m]+"</option>":"")+"</select>&nbsp;")});var h=new Date();var k=(h.getYear()>1900)?0:1900;if(b.minYear<1900){b.minYear=k+h.getYear()+b.minYear}if(b.maxYear<1900){b.maxYear=k+h.getYear()+b.maxYear}for(n=b.maxYear;n>=b.minYear;n--){a("select#"+p.id+"-year").append("<option "+((l&&n==r)?'selected="selected"':"")+' value="'+n+'">'+n+"</option>")}a.each(b.monthNames,function(s,m){a("select#"+p.id+"-month").append("<option "+((l&&s+1==j)?'selected="selected"':"")+' value="'+(s+1)+'">'+m+"</option>")});for(n=1;n<=31;n++){a("select#"+p.id+"-day").append("<option "+((l&&n==q)?'selected="selected"':"")+' class="dateselect-numeric" value="'+n+'">'+e(n)+"</option>")}a("body").on("change","select.dateselect-selector",function(){var v=a(this);if(v.val()!==""){v.find('option[value=""]').remove()}var w=v.parents(".dateselect:first"),t=w.find("select.dateselect-month").val(),A=w.find("select.dateselect-year").val(),z=w.find("select.dateselect-day").val();var u;if(!v.hasClass("dateselect-day")){var x=Math.max(1,t);var s=((x===2)&&(c(A)))?f[x-1]+1:f[x-1];w.find("select.dateselect-day option.dateselect-numeric").remove();z=Math.min(z,s);for(u=1;u<=s;u++){w.find("select.dateselect-day").append('<option class="dateselect-numeric" '+((z==u)?'selected="selected"':"")+' value="'+u+'">'+e(u)+"</option>")}}if((A!=="")&&(t!=="")&&(z!=="")){w.find(".dateselect-input").val(e(A)+"-"+e(t)+"-"+e(z))}})});return a(this)};a.fn.dateselect.defaults={cssClass:"",cssClassSelector:"",maxYear:0,minYear:1900,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],order:["day","month","year"],selectOne:{day:"Day",month:"Month",year:"Year"}}})(jQuery);