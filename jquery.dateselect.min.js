(function(e){e.fn.dateselect=function(t){function r(e){return e%4===0&&(e%100!==0||e%400===0)?true:false}function i(e){e=parseInt(e);return e<10?"0"+e.toString():e}function s(e){var t;var n=function(e,t){e=parseInt(e,10).toString(16);if(t<e.length){return e.slice(e.length-t)}if(t>e.length){return Array(1+(t-e.length)).join("0")+e}return e};if(!this.php_js){this.php_js={}}if(!this.php_js.uniqidSeed){this.php_js.uniqidSeed=Math.floor(Math.random()*123456789)}this.php_js.uniqidSeed++;t=e;t+=n(parseInt((new Date).getTime()/1e3,10),8);t+=n(this.php_js.uniqidSeed,5);return t}t=e.extend({},e.fn.dateselect.defaults,t);var n=[31,28,31,30,31,30,31,31,30,31,30,31];this.each(function(o,u){e(u).addClass("dateselect-input").hide();if(u.id===""){u.id=s("ds")}if(typeof u.tabindex==="undefined"){u.tabindex=0}if(e("#dateselect-"+u.id).length>0){return}var a,f,l,c=[],h=new Date;var p=u.value===""||u.value==="0000-00-00"||null===(a=u.value.match(/[0-9]{4}-[0-9]{2}-[0-9]{2}/))?false:true;if(p){var d=a[0].split("-"),v=parseInt(d[0]),m=parseInt(d[1]),g=parseInt(d[2])}l=e("<div />",{id:"dateselect-"+u.id,"class":"dateselect "+t.cssClass});var y={style:"width: auto !important; min-width: 0 !important",tabindex:e(u).attr("tabindex")};e.each(t.order,function(n,r){e.extend(y,{id:u.id+"-"+r,"class":"dateselect-selector dateselect-"+r+" "+t.cssClassSelector});if(!p){y.html='<option class="dateselect-empty" value="">'+t.selectOne[r]+"</option>"}c[r]=e("<select />",y).appendTo(l).after("&nbsp;")});var b=h.getYear()>1900?0:1900;if(t.minYear<1900){t.minYear=b+h.getYear()+t.minYear}if(t.maxYear<1900){t.maxYear=b+h.getYear()+t.maxYear}for(f=t.maxYear;f>=t.minYear;f--){c["year"].append("<option "+(p&&f===v?'selected="selected"':"")+' value="'+f+'">'+f+"</option>")}for(f in t.monthNames){c["month"].append("<option "+(p&&parseInt(f)+1===m?'selected="selected"':"")+' value="'+(parseInt(f)+1)+'">'+t.monthNames[f]+"</option>")}for(f=1;f<=31;f++){c["day"].append("<option "+(p&&f===g?'selected="selected"':"")+' value="'+f+'">'+i(f)+"</option>")}e(u).hide().before(l);e("body").on("change","select.dateselect-selector",function(){var s=e(this);var o=s.parent().next();if(s.val()!==""){s.find("option.dateselect-empty").remove()}var u=l.find("select.dateselect-month").val(),a=l.find("select.dateselect-year").val(),f=l.find("select.dateselect-day").val();if(!s.hasClass("dateselect-day")){var c=Math.max(1,u);var h=c===2&&r(a)?n[c-1]+1:n[c-1];l.find("select.dateselect-day option.dateselect-numeric").remove();f=Math.min(f,h);for(var p=1;p<=h;p++){l.find("select.dateselect-day").append('<option class="dateselect-numeric" '+(f==p?'selected="selected"':"")+' value="'+p+'">'+i(p)+"</option>")}}if(a!==""&&u!==""&&f!==""){o.val(i(a)+"-"+i(u)+"-"+i(f));t.callback.apply(o.get(0),[new Date(a,u,f)])}else{o.val("")}o.bind("focus")})})};e.fn.dateselect.defaults={cssClass:"",cssClassSelector:"",maxYear:0,minYear:-100,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],order:["day","month","year"],selectOne:{day:"Day",month:"Month",year:"Year"},callback:function(e){}}})(jQuery)